<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Queries | PostGraphQL</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font-size:100%;line-height:1.5em;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:400;word-wrap:break-word;}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.618rem;line-height:2.25rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.33471rem;line-height:2.25rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.21225rem;line-height:1.5rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.5rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.90825rem;line-height:1.5rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.86558rem;line-height:1.5rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}ul{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;padding:1.5rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1rem;line-height:1.5rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}blockquote{margin-left:1.5rem;margin-right:1.5rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.5rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}li > ul{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}code{font-size:0.85rem;line-height:1.5rem;}kbd{font-size:0.85rem;line-height:1.5rem;}samp{font-size:0.85rem;line-height:1.5rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:tnum;padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:calc(0.75rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}</style><style>.demo1-ball{border-radius:99px;background-color:#fff;width:50px;height:50px;border:3px solid #fff;position:absolute;background-size:50px}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media only screen and (min-width:700px){.breakpoint-min-width-700{display:block}.breakpoint-max-width-700{display:none}}@media only screen and (max-width:700px){.breakpoint-min-width-700{display:none}.breakpoint-max-width-700{display:block}}</style><style>
                  a {
                    color: rgb(40,53,147);
                  }
                  .ball-0 {
                    background-image: url(/postgraphql-docs/docs/some-react-code/0.jpg);
                  }
                  .ball-1 {
                    background-image: url(/postgraphql-docs/docs/some-react-code/1.jpg);
                  }
                  .ball-2 {
                    background-image: url(/postgraphql-docs/docs/some-react-code/2.jpg);
                  }
                  .ball-3 {
                    background-image: url(/postgraphql-docs/docs/some-react-code/3.jpg);
                  }
                  .ball-4 {
                    background-image: url(/postgraphql-docs/docs/some-react-code/4.jpg);
                  }
                  .ball-5 {
                    background-image: url(/postgraphql-docs/docs/some-react-code/5.jpg);
                  }
                </style></head><body><div id="react-mount"><div data-reactroot="" data-reactid="1" data-react-checksum="1292120292"><div style="background:rgb(40,53,147);color:rgb(181,186,218);margin-bottom:2.25rem;" data-reactid="2"><div style="max-width:960px;margin-left:auto;margin-right:auto;padding-left:1.125rem;" data-reactid="3"><div style="padding:1.125rem 0;" data-reactid="4"><div style="float:left;margin-left:0%;margin-right:1.694915254237288%;width:32.20338983050847%;clear:none;height:24px;" data-reactid="5"><a style="text-decoration:none;color:rgb(181,186,218);font-size:1.59375rem;" href="/postgraphql-docs/" data-reactid="6">PostGraphQL</a><span style="display:block;clear:both;" data-reactid="7"> </span></div><div style="float:right;margin-left:0%;margin-right:0%;width:66.10169491525423%;clear:none;" data-reactid="8"><a style="float:right;color:rgb(181,186,218);text-decoration:none;margin-left:0.75rem;" href="https://github.com/calebmer/postgraphql" data-reactid="9">GitHub</a><a style="background:rgb(40,53,147);color:rgb(181,186,218);float:right;text-decoration:none;padding-left:0.75rem;padding-right:0.75rem;padding-bottom:1.125rem;margin-bottom:-1.5rem;padding-top:1.5rem;margin-top:-1.5rem;" href="/postgraphql-docs/examples/" data-reactid="10">Examples</a><a style="background:rgb(40,53,147);color:rgb(181,186,218);float:right;text-decoration:none;padding-left:0.75rem;padding-right:0.75rem;padding-bottom:1.125rem;margin-bottom:-1.5rem;padding-top:1.5rem;margin-top:-1.5rem;" href="/postgraphql-docs/api/" data-reactid="11">API</a><a style="background:rgb(40,53,147);color:rgb(181,186,218);float:right;text-decoration:none;padding-left:0.75rem;padding-right:0.75rem;padding-bottom:1.125rem;margin-bottom:-1.5rem;padding-top:1.5rem;margin-top:-1.5rem;" href="/postgraphql-docs/guide/" data-reactid="12">Guide</a><span style="display:block;clear:both;" data-reactid="13"> </span></div><span style="display:block;clear:both;" data-reactid="14"> </span></div><span style="display:block;clear:both;" data-reactid="15"> </span></div></div><div style="max-width:960px;margin-left:auto;margin-right:auto;padding:1.5rem 1.125rem;padding-top:0;" data-reactid="16"><div data-reactid="17"><div class="breakpoint-min-width-700" data-reactid="18"><div style="overflow-y:auto;padding-right:calc(0.75rem - 1px);position:absolute;width:calc(12rem - 1px);border-right:1px solid lightgrey;" data-reactid="19"><ul style="list-style:none;margin-left:0;margin-top:0.75rem;" data-reactid="20"><li style="margin-bottom:0.75rem;" data-reactid="21"><a style="text-decoration:none;" href="/postgraphql-docs/guide/" data-reactid="22">Basic Usage</a></li><li style="margin-bottom:0.75rem;" data-reactid="23"><a style="text-decoration:none;" href="/postgraphql-docs/guide/benefits/" data-reactid="24">Benefits</a></li><li style="margin-bottom:0.75rem;" data-reactid="25"><a style="text-decoration:none;" href="/postgraphql-docs/guide/evaluating/" data-reactid="26">Evaluating PostGraphQL For Your Project</a></li><li style="margin-bottom:0.75rem;" data-reactid="27"><a style="text-decoration:none;" href="/postgraphql-docs/guide/library/" data-reactid="28">Using PostGraphQL as a Library</a></li><li style="margin-bottom:0.75rem;" data-reactid="29"><a style="text-decoration:none;" href="/postgraphql-docs/guide/advanced-queries/" data-reactid="30"><strong data-reactid="31">Advanced Queries</strong></a></li><li style="margin-bottom:0.75rem;" data-reactid="32"><a style="text-decoration:none;" href="/postgraphql-docs/guide/procedures/" data-reactid="33">Procedures</a></li><li style="margin-bottom:0.75rem;" data-reactid="34"><a style="text-decoration:none;" href="/postgraphql-docs/guide/anonymous-role/" data-reactid="35">The Anonymous Role</a></li></ul></div><div style="padding:0 1.5rem;padding-left:calc(12rem + 1.5rem);" data-reactid="36"><div class="markdown" data-reactid="37"><h1 data-reactid="38">Advanced Queries</h1><div data-reactid="39"><p>PostGraphQL, by default only allows you to query the entirety of rows in a table with fields like <code>personNodes</code> or <code>postNodes</code>. This may change in the future when PostGraphQL collaborators find a good way to represent complex queries across multiple columns with multiple operators in the GraphQL type system. Advanced queries allow you to write a query for your app in SQL, not the client, while still using the powerful GraphQL interface.</p>
<p>In the mean time there is another (arguably better) way to specify your own advanced queries with custom logic. By using <a href="../procedures/">procedures</a>!</p>
<p>So let’s write a search query for our <a href="../../examples/forum/">forum example</a> using the PostgreSQL <a href="http://www.postgresql.org/docs/current/static/functions-matching.html"><code>LIKE</code></a> operator (we’ll actually use <code>ILIKE</code> because it is case insensitive). The custom query we create is included in the forum example’s schema, so if you want to run that example locally you can try it out.</p>
<p>The procedure would look like the following. Indentation is non-standard so we can fit in comments to explain what’s going on.</p>
<pre><code class="language-sql"><span class="hljs-comment">-- Our `post` table is created with the following columns. Columns unnecessary</span>
<span class="hljs-comment">-- to this demo were omitted. You can find the full table in our forum example.</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> post (
  …
  headline         <span class="hljs-built_in">text</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">body</span>             <span class="hljs-built_in">text</span>,
  …
);

<span class="hljs-comment">-- Create the function named `search_posts` with a text argument named `search`.</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> search_posts(<span class="hljs-keyword">search</span> <span class="hljs-built_in">text</span>)
  <span class="hljs-comment">-- This function will return a set of posts from the `post` table. The</span>
  <span class="hljs-comment">-- `setof` part is important to PostGraphQL, check out our procedure docs to</span>
  <span class="hljs-comment">-- learn why.</span>
  <span class="hljs-keyword">returns</span> setof post <span class="hljs-keyword">as</span> $$
    <span class="hljs-comment">-- Write our advanced query as a SQL query!</span>
    <span class="hljs-keyword">select</span> *
    <span class="hljs-keyword">from</span> post
    <span class="hljs-keyword">where</span>
      <span class="hljs-comment">-- Use the `ILIKE` operator on both the `headline` and `body` columns. If</span>
      <span class="hljs-comment">-- either return true, return the post.</span>
      headline <span class="hljs-keyword">ilike</span> (<span class="hljs-string">'%'</span> || <span class="hljs-keyword">search</span> || <span class="hljs-string">'%'</span>) <span class="hljs-keyword">or</span>
      <span class="hljs-keyword">body</span> <span class="hljs-keyword">ilike</span> (<span class="hljs-string">'%'</span> || <span class="hljs-keyword">search</span> || <span class="hljs-string">'%'</span>)
  <span class="hljs-comment">-- End the function declaring the language we used as SQL and add the</span>
  <span class="hljs-comment">-- `STABLE` marker so PostGraphQL knows its a query and not a mutation.</span>
  $$ <span class="hljs-keyword">language</span> <span class="hljs-keyword">sql</span> stable;
</code></pre>
<p>And that’s it! You can now use this function in your GraphQL like so:</p>
<pre><code class="language-graphql">{
  searchPosts(<span class="hljs-name">search:</span> <span class="hljs-string">"Hello world"</span>, first: <span class="hljs-number">5</span>) {
    pageInfo {
      hasNextPage
    }
    totalCount
    nodes {
      headline
      body
    }
  }
}
</code></pre>
</div></div></div></div><div class="breakpoint-max-width-700" data-reactid="40"><strong data-reactid="41">Topics:</strong><!-- react-text: 42 --> <!-- /react-text --><select data-reactid="43"><option value="/postgraphql-docs/guide/" data-reactid="44">Basic Usage</option><option value="/postgraphql-docs/guide/benefits/" data-reactid="45">Benefits</option><option value="/postgraphql-docs/guide/evaluating/" data-reactid="46">Evaluating PostGraphQL For Your Project</option><option value="/postgraphql-docs/guide/library/" data-reactid="47">Using PostGraphQL as a Library</option><option selected="" value="/postgraphql-docs/guide/advanced-queries/" data-reactid="48">Advanced Queries</option><option value="/postgraphql-docs/guide/procedures/" data-reactid="49">Procedures</option><option value="/postgraphql-docs/guide/anonymous-role/" data-reactid="50">The Anonymous Role</option></select><br data-reactid="51"/><br data-reactid="52"/><div class="markdown" data-reactid="53"><h1 data-reactid="54">Advanced Queries</h1><div data-reactid="55"><p>PostGraphQL, by default only allows you to query the entirety of rows in a table with fields like <code>personNodes</code> or <code>postNodes</code>. This may change in the future when PostGraphQL collaborators find a good way to represent complex queries across multiple columns with multiple operators in the GraphQL type system. Advanced queries allow you to write a query for your app in SQL, not the client, while still using the powerful GraphQL interface.</p>
<p>In the mean time there is another (arguably better) way to specify your own advanced queries with custom logic. By using <a href="../procedures/">procedures</a>!</p>
<p>So let’s write a search query for our <a href="../../examples/forum/">forum example</a> using the PostgreSQL <a href="http://www.postgresql.org/docs/current/static/functions-matching.html"><code>LIKE</code></a> operator (we’ll actually use <code>ILIKE</code> because it is case insensitive). The custom query we create is included in the forum example’s schema, so if you want to run that example locally you can try it out.</p>
<p>The procedure would look like the following. Indentation is non-standard so we can fit in comments to explain what’s going on.</p>
<pre><code class="language-sql"><span class="hljs-comment">-- Our `post` table is created with the following columns. Columns unnecessary</span>
<span class="hljs-comment">-- to this demo were omitted. You can find the full table in our forum example.</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> post (
  …
  headline         <span class="hljs-built_in">text</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">body</span>             <span class="hljs-built_in">text</span>,
  …
);

<span class="hljs-comment">-- Create the function named `search_posts` with a text argument named `search`.</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> search_posts(<span class="hljs-keyword">search</span> <span class="hljs-built_in">text</span>)
  <span class="hljs-comment">-- This function will return a set of posts from the `post` table. The</span>
  <span class="hljs-comment">-- `setof` part is important to PostGraphQL, check out our procedure docs to</span>
  <span class="hljs-comment">-- learn why.</span>
  <span class="hljs-keyword">returns</span> setof post <span class="hljs-keyword">as</span> $$
    <span class="hljs-comment">-- Write our advanced query as a SQL query!</span>
    <span class="hljs-keyword">select</span> *
    <span class="hljs-keyword">from</span> post
    <span class="hljs-keyword">where</span>
      <span class="hljs-comment">-- Use the `ILIKE` operator on both the `headline` and `body` columns. If</span>
      <span class="hljs-comment">-- either return true, return the post.</span>
      headline <span class="hljs-keyword">ilike</span> (<span class="hljs-string">'%'</span> || <span class="hljs-keyword">search</span> || <span class="hljs-string">'%'</span>) <span class="hljs-keyword">or</span>
      <span class="hljs-keyword">body</span> <span class="hljs-keyword">ilike</span> (<span class="hljs-string">'%'</span> || <span class="hljs-keyword">search</span> || <span class="hljs-string">'%'</span>)
  <span class="hljs-comment">-- End the function declaring the language we used as SQL and add the</span>
  <span class="hljs-comment">-- `STABLE` marker so PostGraphQL knows its a query and not a mutation.</span>
  $$ <span class="hljs-keyword">language</span> <span class="hljs-keyword">sql</span> stable;
</code></pre>
<p>And that’s it! You can now use this function in your GraphQL like so:</p>
<pre><code class="language-graphql">{
  searchPosts(<span class="hljs-name">search:</span> <span class="hljs-string">"Hello world"</span>, first: <span class="hljs-number">5</span>) {
    pageInfo {
      hasNextPage
    }
    totalCount
    nodes {
      headline
      body
    }
  }
}
</code></pre>
</div></div></div></div><span style="display:block;clear:both;" data-reactid="56"> </span></div></div></div><script src="/postgraphql-docs/bundle.js?t=1473678537470"></script></body></html>